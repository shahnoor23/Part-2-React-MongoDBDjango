{"ast":null,"code":"import _extends from 'babel-runtime/helpers/extends';\nimport _classCallCheck from 'babel-runtime/helpers/classCallCheck';\nimport _createClass from 'babel-runtime/helpers/createClass';\nimport _possibleConstructorReturn from 'babel-runtime/helpers/possibleConstructorReturn';\nimport _inherits from 'babel-runtime/helpers/inherits';\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport moment from 'moment';\nimport FullCalendar from 'rc-calendar/es/FullCalendar';\nimport { PREFIX_CLS } from './Constants';\nimport Header from './Header';\nimport { getComponentLocale, getLocaleCode } from '../_util/getLocale';\n\nfunction noop() {\n  return null;\n}\n\nfunction zerofixed(v) {\n  if (v < 10) {\n    return '0' + v;\n  }\n\n  return '' + v;\n}\n\nvar Calendar = function (_React$Component) {\n  _inherits(Calendar, _React$Component);\n\n  function Calendar(props, context) {\n    _classCallCheck(this, Calendar);\n\n    var _this = _possibleConstructorReturn(this, (Calendar.__proto__ || Object.getPrototypeOf(Calendar)).call(this, props, context));\n\n    _this.monthCellRender = function (value) {\n      var _this$props = _this.props,\n          prefixCls = _this$props.prefixCls,\n          _this$props$monthCell = _this$props.monthCellRender,\n          monthCellRender = _this$props$monthCell === undefined ? noop : _this$props$monthCell;\n      return React.createElement('div', {\n        className: prefixCls + '-month'\n      }, React.createElement('div', {\n        className: prefixCls + '-value'\n      }, value.localeData().monthsShort(value)), React.createElement('div', {\n        className: prefixCls + '-content'\n      }, monthCellRender(value)));\n    };\n\n    _this.dateCellRender = function (value) {\n      var _this$props2 = _this.props,\n          prefixCls = _this$props2.prefixCls,\n          _this$props2$dateCell = _this$props2.dateCellRender,\n          dateCellRender = _this$props2$dateCell === undefined ? noop : _this$props2$dateCell;\n      return React.createElement('div', {\n        className: prefixCls + '-date'\n      }, React.createElement('div', {\n        className: prefixCls + '-value'\n      }, zerofixed(value.date())), React.createElement('div', {\n        className: prefixCls + '-content'\n      }, dateCellRender(value)));\n    };\n\n    _this.setValue = function (value, way) {\n      if (!('value' in _this.props)) {\n        _this.setState({\n          value: value\n        });\n      }\n\n      if (way === 'select') {\n        if (_this.props.onSelect) {\n          _this.props.onSelect(value);\n        }\n      } else if (way === 'changePanel') {\n        _this.onPanelChange(value, _this.state.mode);\n      }\n    };\n\n    _this.setType = function (type) {\n      var mode = type === 'date' ? 'month' : 'year';\n\n      if (_this.state.mode !== mode) {\n        _this.setState({\n          mode: mode\n        });\n\n        _this.onPanelChange(_this.state.value, mode);\n      }\n    };\n\n    _this.onHeaderValueChange = function (value) {\n      _this.setValue(value, 'changePanel');\n    };\n\n    _this.onHeaderTypeChange = function (type) {\n      _this.setType(type);\n    };\n\n    _this.onSelect = function (value) {\n      _this.setValue(value, 'select');\n    }; // Make sure that moment locale had be set correctly.\n\n\n    getComponentLocale(props, context, 'Calendar', function () {\n      return require('./locale/zh_CN');\n    });\n    var value = props.value || props.defaultValue || moment();\n\n    if (!moment.isMoment(value)) {\n      throw new Error('The value/defaultValue of Calendar must be a moment object after `antd@2.0`, ' + 'see: https://u.ant.design/calendar-value');\n    }\n\n    _this.state = {\n      value: value,\n      mode: props.mode\n    };\n    return _this;\n  }\n\n  _createClass(Calendar, [{\n    key: 'componentWillReceiveProps',\n    value: function componentWillReceiveProps(nextProps) {\n      if ('value' in nextProps) {\n        this.setState({\n          value: nextProps.value\n        });\n      }\n    }\n  }, {\n    key: 'onPanelChange',\n    value: function onPanelChange(value, mode) {\n      var onPanelChange = this.props.onPanelChange;\n\n      if (onPanelChange) {\n        onPanelChange(value, mode);\n      }\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var state = this.state,\n          props = this.props,\n          context = this.context;\n      var value = state.value,\n          mode = state.mode;\n      var localeCode = getLocaleCode(context);\n\n      if (value && localeCode) {\n        value.locale(localeCode);\n      }\n\n      var prefixCls = props.prefixCls,\n          style = props.style,\n          className = props.className,\n          fullscreen = props.fullscreen,\n          dateFullCellRender = props.dateFullCellRender,\n          monthFullCellRender = props.monthFullCellRender;\n      var type = mode === 'year' ? 'month' : 'date';\n      var locale = getComponentLocale(props, context, 'Calendar', function () {\n        return require('./locale/zh_CN');\n      });\n      var cls = className || '';\n\n      if (fullscreen) {\n        cls += ' ' + prefixCls + '-fullscreen';\n      }\n\n      var monthCellRender = monthFullCellRender || this.monthCellRender;\n      var dateCellRender = dateFullCellRender || this.dateCellRender;\n      return React.createElement('div', {\n        className: cls,\n        style: style\n      }, React.createElement(Header, {\n        fullscreen: fullscreen,\n        type: type,\n        value: value,\n        locale: locale.lang,\n        prefixCls: prefixCls,\n        onTypeChange: this.onHeaderTypeChange,\n        onValueChange: this.onHeaderValueChange\n      }), React.createElement(FullCalendar, _extends({}, props, {\n        Select: noop,\n        locale: locale.lang,\n        type: type,\n        prefixCls: prefixCls,\n        showHeader: false,\n        value: value,\n        monthCellRender: monthCellRender,\n        dateCellRender: dateCellRender,\n        onSelect: this.onSelect\n      })));\n    }\n  }]);\n\n  return Calendar;\n}(React.Component);\n\nexport default Calendar;\nCalendar.defaultProps = {\n  locale: {},\n  fullscreen: true,\n  prefixCls: PREFIX_CLS,\n  mode: 'month',\n  onSelect: noop,\n  onPanelChange: noop\n};\nCalendar.propTypes = {\n  monthCellRender: PropTypes.func,\n  dateCellRender: PropTypes.func,\n  monthFullCellRender: PropTypes.func,\n  dateFullCellRender: PropTypes.func,\n  fullscreen: PropTypes.bool,\n  locale: PropTypes.object,\n  prefixCls: PropTypes.string,\n  className: PropTypes.string,\n  style: PropTypes.object,\n  onPanelChange: PropTypes.func,\n  value: PropTypes.object,\n  onSelect: PropTypes.func\n};\nCalendar.contextTypes = {\n  antLocale: PropTypes.object\n};","map":null,"metadata":{},"sourceType":"module"}