{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _reactDom = require('react-dom');\n\nvar _reactDom2 = _interopRequireDefault(_reactDom);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _classnames = require('classnames');\n\nvar _classnames2 = _interopRequireDefault(_classnames);\n\nvar _util = require('./util');\n\nvar _Star = require('./Star');\n\nvar _Star2 = _interopRequireDefault(_Star);\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    \"default\": obj\n  };\n}\n\nfunction _defaults(obj, defaults) {\n  var keys = Object.getOwnPropertyNames(defaults);\n\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    var value = Object.getOwnPropertyDescriptor(defaults, key);\n\n    if (value && value.configurable && obj[key] === undefined) {\n      Object.defineProperty(obj, key, value);\n    }\n  }\n\n  return obj;\n}\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : _defaults(subClass, superClass);\n}\n\nfunction noop() {}\n\nvar Rate = function (_React$Component) {\n  _inherits(Rate, _React$Component);\n\n  function Rate(props) {\n    _classCallCheck(this, Rate);\n\n    var _this = _possibleConstructorReturn(this, _React$Component.call(this, props));\n\n    _initialiseProps.call(_this);\n\n    var value = props.value;\n\n    if (value === undefined) {\n      value = props.defaultValue;\n    }\n\n    _this.state = {\n      value: value\n    };\n    return _this;\n  }\n\n  Rate.prototype.componentWillReceiveProps = function componentWillReceiveProps(nextProps) {\n    if ('value' in nextProps) {\n      var value = nextProps.value;\n\n      if (value === undefined) {\n        value = nextProps.defaultValue;\n      }\n\n      this.setState({\n        value: value\n      });\n    }\n  };\n\n  Rate.prototype.getStarDOM = function getStarDOM(index) {\n    return _reactDom2[\"default\"].findDOMNode(this.refs['star_' + index]);\n  };\n\n  Rate.prototype.getStarValue = function getStarValue(index, x) {\n    var value = index + 1;\n\n    if (this.props.allowHalf) {\n      var leftEdge = (0, _util.getOffsetLeft)(this.getStarDOM(0));\n      var width = (0, _util.getOffsetLeft)(this.getStarDOM(1)) - leftEdge;\n\n      if (x - leftEdge - width * index < width / 2) {\n        value -= 0.5;\n      }\n    }\n\n    return value;\n  };\n\n  Rate.prototype.render = function render() {\n    var _props = this.props,\n        count = _props.count,\n        allowHalf = _props.allowHalf,\n        style = _props.style,\n        prefixCls = _props.prefixCls,\n        disabled = _props.disabled,\n        className = _props.className,\n        character = _props.character;\n    var _state = this.state,\n        value = _state.value,\n        hoverValue = _state.hoverValue;\n    var stars = [];\n    var disabledClass = disabled ? prefixCls + '-disabled' : '';\n\n    for (var index = 0; index < count; index++) {\n      stars.push(_react2[\"default\"].createElement(_Star2[\"default\"], {\n        ref: 'star_' + index,\n        index: index,\n        disabled: disabled,\n        prefixCls: prefixCls + '-star',\n        allowHalf: allowHalf,\n        value: hoverValue === undefined ? value : hoverValue,\n        onClick: this.onClick,\n        onHover: this.onHover,\n        key: index,\n        character: character\n      }));\n    }\n\n    return _react2[\"default\"].createElement('ul', {\n      className: (0, _classnames2[\"default\"])(prefixCls, disabledClass, className),\n      style: style,\n      onMouseLeave: disabled ? null : this.onMouseLeave\n    }, stars);\n  };\n\n  return Rate;\n}(_react2[\"default\"].Component);\n\nRate.propTypes = {\n  disabled: _propTypes2[\"default\"].bool,\n  value: _propTypes2[\"default\"].number,\n  defaultValue: _propTypes2[\"default\"].number,\n  count: _propTypes2[\"default\"].number,\n  allowHalf: _propTypes2[\"default\"].bool,\n  style: _propTypes2[\"default\"].object,\n  prefixCls: _propTypes2[\"default\"].string,\n  onChange: _propTypes2[\"default\"].func,\n  onHoverChange: _propTypes2[\"default\"].func,\n  className: _propTypes2[\"default\"].string,\n  character: _propTypes2[\"default\"].node\n};\nRate.defaultProps = {\n  defaultValue: 0,\n  count: 5,\n  allowHalf: false,\n  style: {},\n  prefixCls: 'rc-rate',\n  onChange: noop,\n  character: 'â˜…',\n  onHoverChange: noop\n};\n\nvar _initialiseProps = function _initialiseProps() {\n  var _this2 = this;\n\n  this.onHover = function (event, index) {\n    var hoverValue = _this2.getStarValue(index, event.pageX);\n\n    _this2.setState({\n      hoverValue: hoverValue\n    });\n\n    _this2.props.onHoverChange(hoverValue);\n  };\n\n  this.onMouseLeave = function () {\n    _this2.setState({\n      hoverValue: undefined\n    });\n\n    _this2.props.onHoverChange(undefined);\n  };\n\n  this.onClick = function (event, index) {\n    var value = _this2.getStarValue(index, event.pageX);\n\n    if (!('value' in _this2.props)) {\n      _this2.setState({\n        value: value\n      });\n    }\n\n    _this2.onMouseLeave();\n\n    _this2.props.onChange(value);\n  };\n};\n\nexports[\"default\"] = Rate;\nmodule.exports = exports['default'];","map":null,"metadata":{},"sourceType":"script"}